# Data Model: RAG Pipeline

## Document Chunk
**Description**: Represents a segment of extracted content with metadata and vector embedding

**Fields**:
- `id` (string): Unique identifier for the chunk (UUID or URL + chunk index)
- `url` (string): Source URL of the content
- `section` (string): Section name/identifier from the documentation
- `heading` (string): Heading/title of the content segment
- `chunk_index` (integer): Sequential index of the chunk within the document
- `content` (string): Cleaned and processed text content
- `embedding` (list[float]): Vector embedding generated by Cohere model
- `created_at` (datetime): Timestamp when the chunk was created
- `updated_at` (datetime): Timestamp when the chunk was last updated

**Validation Rules**:
- URL must be a valid HTTP/HTTPS URL
- Content must not exceed Cohere model token limits
- Embedding vector must have consistent dimensions based on the model used
- All required fields must be present

## Crawled Page
**Description**: Raw web page content extracted from the Docusaurus website with URL and structure information

**Fields**:
- `url` (string): Source URL of the page
- `title` (string): Page title extracted from HTML
- `content_html` (string): Raw HTML content of the page
- `content_text` (string): Extracted plain text from HTML
- `headings` (list[dict]): List of headings with hierarchy (level, text, id)
- `status_code` (integer): HTTP status code from the request
- `crawl_timestamp` (datetime): When the page was crawled
- `fingerprint` (string): Content hash to detect changes for incremental updates

**Validation Rules**:
- URL must be valid and accessible
- Content text should not be empty after extraction
- Status code should be 200 for successful crawl

## Processing Configuration
**Description**: Parameters that control the pipeline behavior including content selection criteria, chunking rules, and API settings

**Fields**:
- `base_url` (string): Root URL of the Docusaurus website to crawl
- `include_patterns` (list[string]): URL patterns to include in crawling
- `exclude_patterns` (list[string]): URL patterns to exclude from crawling
- `chunk_size` (integer): Maximum number of characters per chunk
- `chunk_overlap` (integer): Number of characters to overlap between chunks
- `cohere_model` (string): Name of the Cohere embedding model to use
- `cohere_api_key` (string): API key for Cohere service
- `qdrant_url` (string): URL for Qdrant Cloud instance
- `qdrant_api_key` (string): API key for Qdrant Cloud
- `batch_size` (integer): Number of chunks to process in each batch
- `max_retries` (integer): Maximum number of retries for failed operations
- `delay_between_requests` (float): Delay in seconds between HTTP requests

**Validation Rules**:
- Base URL must be a valid URL
- Chunk size must be within Cohere model limits
- API keys must be provided
- Batch size should be reasonable (not too large for memory constraints)

## Embedding Vector
**Description**: High-dimensional numerical representation of text content generated by Cohere model

**Fields**:
- `vector` (list[float]): The actual embedding vector
- `model_name` (string): Name of the model that generated the embedding
- `model_version` (string): Version of the model that generated the embedding
- `input_text` (string): Original text that was embedded (or hash of it)
- `dimension` (integer): Number of dimensions in the vector

**Validation Rules**:
- Vector must have consistent dimensions based on the model
- All values must be valid floating-point numbers
- Model name and version must match the expected Cohere model

## State Relationships
- **Crawled Page** → **Document Chunk**: One-to-many relationship (one page can be chunked into multiple chunks)
- **Processing Configuration** → **Document Chunk**: One-to-many relationship (configuration parameters applied to generate multiple chunks)
- **Embedding Vector** → **Document Chunk**: One-to-one relationship (each chunk has one corresponding embedding)